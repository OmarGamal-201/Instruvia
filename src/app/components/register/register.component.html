<div class="register-container" [class.rtl]="isRTL">
  <div class="register-card">
    <!-- Language Switcher -->
    <div class="language-switcher">
      <button
        type="button"
        class="lang-btn"
        [class.active]="currentLang === 'en'"
        (click)="toggleLanguage()">
        <span class="flag">EN</span>
      </button>
      <button
        type="button"
        class="lang-btn"
        [class.active]="currentLang === 'ar'"
        (click)="toggleLanguage()">
        <span class="flag"> AR</span>
      </button>
    </div>

    <!-- Logo and Header -->
    <div class="header">
      <div class="logo">
        <img src="../../../assets/logo.png" alt="logo" style="width: 32px; height: 32px;">
        <span class="logo-text">Instruvia</span>
      </div>
      <h1>{{ t.header.title }}</h1>
      <p class="subtitle">{{ t.header.subtitle }}</p>
    </div>

    <!-- Registration Form -->
    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <!-- Error Message -->
      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>

      <!-- Full Name -->
      <div class="form-group">
        <label for="fullName">{{ t.form.name }}</label>
        <div class="input-wrapper">
          <svg class="input-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M10 10C12.21 10 14 8.21 14 6C14 3.79 12.21 2 10 2C7.79 2 6 3.79 6 6C6 8.21 7.79 10 10 10ZM10 12C7.33 12 2 13.34 2 16V18H18V16C18 13.34 12.67 12 10 12Z" fill="#9CA3AF"/>
          </svg>
          <input
            type="text"
            id="fullName"
            formControlName="name"
            [placeholder]="t.form.fullNamePlaceholder"
            [class.invalid]="registerForm.get('name')?.invalid && registerForm.get('name')?.touched">
        </div>
      </div>
      <small *ngIf="hasError('name','required')">{{ t.err.fullNameRequired }}</small>
      <small *ngIf="hasError('name','minlength')">{{t.err.fullNameMin}}</small>

      <!-- Email -->
      <div class="form-group">
        <label for="email">{{ t.form.email }}</label>
        <div class="input-wrapper">
          <svg class="input-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M18 4H2C0.9 4 0.01 4.9 0.01 6L0 14C0 15.1 0.9 16 2 16H18C19.1 16 20 15.1 20 14V6C20 4.9 19.1 4 18 4ZM18 8L10 11.5L2 8V6L10 9.5L18 6V8Z" fill="#9CA3AF"/>
          </svg>
          <input
            type="email"
            id="email"
            formControlName="email"
            [placeholder]="t.form.emailPlaceholder"
            [class.invalid]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
        </div>
      </div>
      <small *ngIf="hasError('email','required')">{{t.err.emailRequired}}</small>
      <small *ngIf="hasError('email','email')">{{t.err.emailValid}}</small>

      <!-- Password -->
      <div class="form-group">
        <label for="password">{{ t.form.password }}</label>
        <div class="input-wrapper">
          <svg class="input-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M15 7H14V5C14 2.79 12.21 1 10 1C7.79 1 6 2.79 6 5V7H5C3.9 7 3 7.9 3 9V17C3 18.1 3.9 19 5 19H15C16.1 19 17 18.1 17 17V9C17 7.9 16.1 7 15 7ZM10 14C8.9 14 8 13.1 8 12C8 10.9 8.9 10 10 10C11.1 10 12 10.9 12 12C12 13.1 11.1 14 10 14ZM11.1 7H8.9V5C8.9 3.29 10.29 1.9 12 1.9C13.71 1.9 15.1 3.29 15.1 5V7H11.1Z" fill="#9CA3AF"/>
          </svg>
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="password"
            formControlName="password"
            [placeholder]="t.form.passwordPlaceholder"
            [class.invalid]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
          <button type="button" class="toggle-password" (click)="togglePasswordVisibility()">
            <svg *ngIf="!showPassword" width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M10 4.5C5 4.5 1.73 7.61 1 10C1.73 12.39 5 15.5 10 15.5C15 15.5 18.27 12.39 19 10C18.27 7.61 15 4.5 10 4.5ZM10 13.5C7.52 13.5 5.5 11.48 5.5 9C5.5 6.52 7.52 4.5 10 4.5C12.48 4.5 14.5 6.52 14.5 9C14.5 11.48 12.48 13.5 10 13.5ZM10 6.5C8.62 6.5 7.5 7.62 7.5 9C7.5 10.38 8.62 11.5 10 11.5C11.38 11.5 12.5 10.38 12.5 9C12.5 7.62 11.38 6.5 10 6.5Z" fill="#9CA3AF"/>
            </svg>
            <svg *ngIf="showPassword" width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M10 6.5C12.48 6.5 14.5 8.52 14.5 11C14.5 11.64 14.37 12.25 14.13 12.81L16.56 15.24C17.93 14.07 19.03 12.56 19.73 11C18.27 7.61 14.53 5 10 5C8.83 5 7.71 5.2 6.66 5.56L8.52 7.42C9.08 7.18 9.69 7.05 10.33 7.05L10 6.5ZM1.71 1.71L3.68 3.68L4.13 4.13C2.62 5.31 1.41 6.88 0.73 8.68C2.19 12.07 5.93 14.68 10.46 14.68C11.77 14.68 13.02 14.43 14.16 13.98L14.56 14.38L17.31 17.13L18.72 15.72L3.13 0.13L1.71 1.71ZM6.92 6.92L8.43 8.43C8.34 8.63 8.29 8.85 8.29 9.08C8.29 10.46 9.4 11.57 10.78 11.57C11.01 11.57 11.23 11.52 11.43 11.43L12.94 12.94C12.35 13.23 11.69 13.39 11 13.39C8.52 13.39 6.5 11.37 6.5 8.89C6.5 8.2 6.66 7.54 6.95 6.95L6.92 6.92Z" fill="#9CA3AF"/>
            </svg>
          </button>
        </div>
      </div>
      <small *ngIf="hasError('password','required')">{{t.err.passwordRequired}}</small>
      <small *ngIf="hasError('password','minlength')">{{t.err.passwordMin}}</small>
      <small *ngIf="hasError('password','pattern')">{{t.err.passwordPattern}}</small>
      <!-- Terms Checkbox -->
      <div class="checkbox-group">
        <input
          type="checkbox"
          id="agreeToTerms"
          formControlName="agreeToTerms">
        <label for="agreeToTerms">
          {{ t.form.agreeToTerms }}
          <a href="/terms" target="_blank">{{ t.form.terms }}</a>
          {{ t.form.and }}
          <a href="/privacy" target="_blank">{{ t.form.privacy }}</a>
        </label>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="submit-btn" [disabled]="!registerForm.valid || isSubmitting">
        <span *ngIf="!isSubmitting">{{ t.form.createAccount }}</span>
        <span *ngIf="isSubmitting" class="spinner">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" opacity="0.25"/>
            <path d="M12 2a10 10 0 0 1 10 10" stroke="currentColor" stroke-width="4" stroke-linecap="round"/>
          </svg>
          {{ currentLang === 'en' ? 'Creating...' : 'جاري الإنشاء...' }}
        </span>
      </button>
    </form>

    <!-- Info Box -->
    <div class="info-box">
      <p class="info-title">{{ t.info.title }}</p>
      <p class="info-text">{{ t.info.text }}</p>
    </div>

    <!-- Sign In Link -->
    <div class="signin-link">
      {{ t.links.alreadyHaveAccount }} <a (click)="navigateToSignIn()">{{ t.links.signIn }}</a>
    </div>

    <!-- Back to Home -->
    <a class="back-link" (click)="navigateToHome()">{{ t.links.backToHome }}</a>
  </div>
</div>
